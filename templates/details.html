<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Incident Details</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <h1>Incident Details: {{ incident.title }}</h1>

    <div class="details-container">
        <p><strong>Title:</strong> {{ incident.title }}</p>
        <p><strong>Description:</strong> {{ incident.description }}</p>
        <p><strong>Status:</strong> {{ incident.status }}</p>
        <p><strong>Priority:</strong> {{ incident.priority }}</p>
        <p><strong>Operator:</strong> {{ incident.operator }}</p>
        <p><strong>Type:</strong> {{ incident.type }}</p>
        <p><strong>Work Duration:</strong> {{ incident.work_duration }}</p>
    </div>

    <div class="section-container">
        <h2>Update Incident</h2>
        <form action="{{ url_for('update_incident', unique_id=incident.unique_id) }}" method="post">
            <div class="form-row">
                <label for="status">New Status:</label>
                <select id="status" name="status">
                    <option value="Open" {% if incident.status == 'Open' %}selected{% endif %}>Open</option>
                    <option value="In Progress" {% if incident.status == 'In Progress' %}selected{% endif %}>In Progress</option>
                    <option value="On Hold" {% if incident.status == 'On Hold' %}selected{% endif %}>On Hold</option>
                    <option value="Resolved" {% if incident.status == 'Resolved' %}selected{% endif %}>Resolved</option>
                    <option value="Closed" {% if incident.status == 'Closed' %}selected{% endif %}>Closed</option>
                </select>
            </div>

            <div class="form-row">
                <label for="description">New Description:</label>
                <textarea id="description" name="description">{{ incident.description }}</textarea>
            </div>

            <div class="form-row">
                <label for="operator">New Operator:</label>
                <input type="text" id="operator" name="operator" value="{{ incident.operator }}" required>
            </div>

            <button type="submit">Update</button>
        </form>
    </div>

    <div class="history-container">
        <h2>Update History</h2>
        <ul>
            {% for update in incident.history %}
                <li>
                    <strong>Date/Time:</strong> {{ update.timestamp }}<br>
                    <strong>Status:</strong> {{ update.status }}<br>
                    <strong>Operator:</strong> {{ update.operator }}<br>
                    <strong>Description:</strong> {{ update.description }}
                </li>
            {% endfor %}
        </ul>
    </div>
    <a href="{{ url_for('index') }}">Back to incident list</a>
</body>
</html>